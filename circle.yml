
## Customize the test machine
machine:
  # Version of ruby to use
  ruby:
    version:
      2.2.1
## Customize dependencies
dependencies:
  pre:
     - "mysql -e 'create database peatio_test;'"
     - "cp ./.travis.database.yml ./config/database.yml"
     - "cp ./.travis.application.yml ./config/application.yml"
     - "cp ./.travis.currencies.yml ./config/currencies.yml"
     - "cp ./.travis.markets.yml ./config/markets.yml"
     - "cp ./config/amqp.yml.example ./config/amqp.yml"
     - "mkdir -p ./tmp/cache"
     - "sudo apt-get update"
     - "sudo apt-get install build-essential chrpath git-core libssl-dev libfontconfig1-dev"
     - "cd /usr/local/share"
     - "PHANTOMJS_VERISON=1.9.8"
     - "sudo wget https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-$PHANTOMJS_VERISON-linux-x86_64.tar.bz2"
     - "sudo tar xjf phantomjs-$PHANTOMJS_VERISON-linux-x86_64.tar.bz2"
     - "sudo ln -s /usr/local/share/phantomjs-$PHANTOMJS_VERISON-linux-x86_64/bin/phantomjs /usr/local/share/phantomjs"
     - "sudo ln -s /usr/local/share/phantomjs-$PHANTOMJS_VERISON-linux-x86_64/bin/phantomjs /usr/local/bin/phantomjs"
     - "sudo ln -s /usr/local/share/phantomjs-$PHANTOMJS_VERISON-linux-x86_64/bin/phantomjs /usr/bin/phantomjs"

## Customize database setup
database:
  override:
    # replace CircleCI's generated database.yml
    - bundle exec rake db:schema:load
    - bundle exec rake db:test:prepare
    - bundle exec rake spec --trace
  
  
  
 
